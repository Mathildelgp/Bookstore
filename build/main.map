{"version":3,"sources":["webpack:///webpack/bootstrap 28aa7e218de12af8b0ff","webpack:///external \"express\"","webpack:///external \"mongoose\"","webpack:///external \"bcrypt\"","webpack:///./src/index.js","webpack:///external \"dotenv/config\"","webpack:///external \"volleyball\"","webpack:///external \"express-session\"","webpack:///external \"path\"","webpack:///external \"connect-flash\"","webpack:///./src/routes/about.js","webpack:///./src/routes/user.js","webpack:///./src/models/user.js","webpack:///./src/routes/books.js","webpack:///./src/models/book.js","webpack:///external \"multer\""],"names":["console","log","PORT","db_url","process","env","mongoose","connect","db","connection","on","error","bind","once","app","express","set","path","join","__dirname","use","static","urlencoded","extended","json","get","req","res","render","listen","AboutRouter","Router","userRouter","post","next","newRegister","body","save","err","user","send","location","redirect","email","password","User","authenticate","Error","status","Schema","UserSchema","username","type","String","index","name","statics","cb","findOne","exec","cd","bcrypt","compare","result","pre","hash","model","bookRouter","storage","multer","diskStorage","destination","file","filename","Date","now","originalname","upload","single","datas","newBook","book","Book","find","books","_id","params","id","findById","BookSchema","price","img"],"mappings":"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","file":"main.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 3);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 28aa7e218de12af8b0ff","module.exports = require(\"express\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"express\"\n// module id = 0\n// module chunks = 0","module.exports = require(\"mongoose\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"mongoose\"\n// module id = 1\n// module chunks = 0","module.exports = require(\"bcrypt\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"bcrypt\"\n// module id = 2\n// module chunks = 0","console.log('coucou')\nimport express from 'express'\nimport 'dotenv/config'\nconst { PORT, db_url } = process.env\n\nimport volleyball from 'volleyball'\nimport session from 'express-session'\nimport path from 'path'\nimport flash from 'connect-flash'\nimport { AboutRouter } from './routes/about'\nimport { userRouter } from './routes/user'\nimport { bookRouter } from './routes/books'\nimport mongoose from 'mongoose'\n\nmongoose.connect(db_url);\nvar db = mongoose.connection;\ndb.on('error', console.error.bind(console, 'connection error:'));\ndb.once('open', function() {\n  console.log('ça marche avec mongo')\n});\n\nconst app = express()\n\n// view engine setup\napp.set(\"views\", path.join(__dirname, 'views'))\napp.set(\"view engine\", \"pug\") \napp.use(express.static( path.join(__dirname, \"../public\")))\napp.use(express.urlencoded({extended:true}))\napp.use(express.json())\napp.use(volleyball)\n\napp.get('/', (req, res) =>{\n\tres.render('home')\n})\napp.use('/about', AboutRouter)\napp.use('/user', userRouter)\napp.use('/books', bookRouter)\n\napp.listen(PORT, () => {\n\tconsole.log(`ca marche sur le port ${PORT}`)\n})\n\n\n// WEBPACK FOOTER //\n// ./src/index.js","module.exports = require(\"dotenv/config\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"dotenv/config\"\n// module id = 5\n// module chunks = 0","module.exports = require(\"volleyball\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"volleyball\"\n// module id = 6\n// module chunks = 0","module.exports = require(\"express-session\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"express-session\"\n// module id = 7\n// module chunks = 0","module.exports = require(\"path\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"path\"\n// module id = 8\n// module chunks = 0","module.exports = require(\"connect-flash\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"connect-flash\"\n// module id = 9\n// module chunks = 0","import express from 'express'\nconst AboutRouter = express.Router()\n\nAboutRouter.get('/', (req, res) => {\n\tres.render('about')\n})\n\nexport { AboutRouter }\n\n\n// WEBPACK FOOTER //\n// ./src/routes/about.js","import express from 'express'\nconst userRouter = express.Router()\nimport { User } from '../models/user'\n\nuserRouter.get('/register', (req, res) => {\n\tres.render('register')\n})\n\nuserRouter.post('/register', (req, res, next) => {\n\tconst newRegister = new User(req.body)\n\tnewRegister.save((err, user) => {\n\t\tif(err) res.send(err)\n\t\t\tconsole.log(user)\n\t})\n\tres.location('/user/login')\n\tres.redirect('/user/login')\n})\n\nuserRouter.get('/login', (req, res) => {\n\tres.render('login')\n})\n\nuserRouter.post('/login', (req, res, next) => {\n\tif(req.body.email && req.body.password){\n\t\tUser.authenticate(req.body.email, req.body.password, function(err, user){\n\t\t\tif (err || !user) {\n\t\t\t\tvar err = new Error(\"Email ou mot de passe introuvable\")\n\t\t\t\terr.status = 401\n\t\t\t\treturn next(err)\n\t\t\t}else{\n\t\t\t\treturn res.redirect('/')\n\t\t\t}\n\t\t})\n\t}\n})\n\n\nexport { userRouter }\n\n\n// WEBPACK FOOTER //\n// ./src/routes/user.js","import mongoose from 'mongoose'\nconst Schema = mongoose.Schema\nimport bcrypt from 'bcrypt'\n\nconst UserSchema = new Schema ({\n\tusername : {type:String, index:true},\n\tname : {type:String, index:true},\n\temail : {type:String, index:true},\n\tpassword : {type:String}\n})\n\nUserSchema.statics.authenticate = function(email, password, cb){\n\tUser.findOne({email:email})\n\t\t.exec(function(err, user){\n\t\t\tif (err) {\n\t\t\t\treturn cd(err)\n\t\t\t}else if (!user){\n\t\t\t\tvar error = new Error('Utilisateur introuvable')\n\t\t\t\terror.status = 401\n\t\t\t\treturn cd(error)\n\t\t\t}\n\t\t\tbcrypt.compare(password, user.password, function(error, result){\n\t\t\t\tif(result === true){\n\t\t\t\t\treturn cb(null, user)\n\t\t\t\t}else{\n\t\t\t\t\treturn cb()\n\t\t\t}\n\t\t})\n\t})\n}\nUserSchema.pre('save', function(next){\n\tconst user = this;\n\tbcrypt.hash(user.password, 10, function (err, hash) {\n\t\tif(err) return next(err)\n\t\tuser.password = hash;\n\t\tnext()\n\t})\n})\n\nconst User = mongoose.model('User', UserSchema)\nexport { User }\n\n\n\n// WEBPACK FOOTER //\n// ./src/models/user.js","import express from 'express'\nconst bookRouter = express.Router()\nimport { Book } from '../models/book'\nimport multer from 'multer'\nvar storage = multer.diskStorage({\n  destination: function (req, file, cb) {\n    cb(null, './public/uploads/')\n  },\n  filename: function (req, file, cb) {\n    cb(null, Date.now()+ '-' +file.originalname)\n  }\n})\n\nconst upload = multer({ storage: storage}).single(\"img\")\n\nbookRouter.get('/add_book', (req, res) => {\n\tres.render('addBook')\n})\n\nbookRouter.post('/add_book', upload, (req, res) => {\n\tconst datas = req.body\n\tdatas[\"img\"]=req.file.filename\n\tconst newBook = new Book(datas)\n\t\tnewBook.save((err, book) => {\n\t\tif (err) res.send(err)\n\t\t\tres.redirect('/books')\n\t})\n})\n\nbookRouter.get('/', (req, res) => {\n\tBook.find({}, (err, books) => {\n\t\tif (err) res.send(err)\n\t\t\tres.render('book', {books})\n\t})\n})\n\nbookRouter.get('/:id', (req, res) => {\n\tlet _id = req.params.id\n\tBook.findById({_id}, (err, book) => {\n\t\tif (err) res.send(err)\n\t\t\tres.render('oneBook', {book})\n\t})\n})\n\nexport { bookRouter }\n\n\n// WEBPACK FOOTER //\n// ./src/routes/books.js","import mongoose from 'mongoose'\nconst Schema = mongoose.Schema\nimport bcrypt from 'bcrypt'\n\nconst BookSchema = new Schema ({\n\tname : String,\n\tprice: String,\n\timg:{type: String}\n})\n\nconst Book = mongoose.model('Book', BookSchema)\nexport { Book }\n\n\n\n// WEBPACK FOOTER //\n// ./src/models/book.js","module.exports = require(\"multer\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"multer\"\n// module id = 15\n// module chunks = 0"],"sourceRoot":""}